

낙관적 업데이트

- 비관적 업데이트 방식
사용자 클릭 -> 로딩 표시 -> 서버 요청 -> 응답 대기
-> 성공 UI 업데이트 

시간:       0ms       500ms    1000ms   1500ms
            [클릭] →  [로딩] → [대기] → [완료]
체크박스:   □      →    □    →   □    →   ☑


- 낙관적 업데이트 방식
  
사용자 클릭 -> UI 업데이트 -> 서버 요청 -> 끝

사용자 클릭 -> UI 업데이트 -> 서버 요청 -> 
실패 할 때 롤백


시간:      0ms       500ms        1000ms       1500ms
          [클릭] → [즉시변경] → [백그라운드] → [동기화]
체크박스:    □   →     ☑     →     ☑        →   ☑


- 낙관적 업데이트  4단계 
1) mutationFn
서버에 추가 요청을 보내는 함수
2) onMutate
요청이 서버로 가기 전에 실행
이 부분에서  낙관적 업데이트(Optimistic Update) 진행
서버의 응답과 관계 없이 UI에 반영
3) onError
서버 요청이 실패했을 때 실행
낙관적 업데이트를 롤백(원상복구)
4) onSettled
성공/실패와 상관없이 요청이 끝나면 실행
보통 이 부분에서 쿼리로 최슨 데이터로 동기화 진행

장점
- 빠른 반응성
- 로딩 시간이 없다
- 자연스러우 느낌을 낼 수 있다.
- 오프라인 지원 : 네트워크 없어도 동작 가능 
단점
- 복잡성 올라감 
- 일관성이 깨질 수 있음
- 실패 했을 사용자 명확하게 피드백을 제공 


사용하는 곳 
- 토글, 좋아요, 삭제 
- 성공확률이 높은 곳 

부적합 경우
- 금융, 의료 부분
- 서버 검증이 필요한 경우
- 상태 관리하는 것이 여러 컴포넌트 연관되는 애들 
